


<!DOCTYPE HTML>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
	<head>
		<meta charset="utf-8">
		
		<meta http-equiv="content-type" content="text/html; charset=UTF-8"/>
		<link rel="stylesheet" href="https://static.cloud.coveo.com/searchui/v2.4382/css/CoveoFullSearch.css"/>
		<meta http-equiv="X-UA-Compatible" content="IE=edge"/>
		<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
		<meta name="description"/>
		<meta name="keywords"/>
		<meta property="og:title" content=""/>
		<meta property="og:description"/>
		<!-- favicon -->
		<link rel="icon" type="image/vnd.microsoft.icon" href="../../_static/favicon.ico"/>
		<link rel="shortcut icon" type="image/vnd.microsoft.icon" href="../../_static/favicon.ico"/>
		<!-- Fonts -->
		<link href="https://fonts.googleapis.com/css?family=Roboto:300,400,500" rel="stylesheet" type="text/css"/>

	<!-- OneTrust Cookies Consent Notice start for xilinx.github.io -->
<script src="https://cdn.cookielaw.org/scripttemplates/otSDKStub.js" data-document-language="true" type="text/javascript" charset="UTF-8" data-domain-script="37701bd4-e5c0-4ee3-9329-e7475d0b13a7" ></script>
<script type="text/javascript">
function OptanonWrapper() { }
</script>
<!-- OneTrust Cookies Consent Notice end for xilinx.github.io -->
		<!-- Google Tag Manager -->
	<script type="text/plain" class="optanon-category-C0002">(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
	new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
	j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
	'//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
	})(window,document,'script','dataLayer','GTM-5RHQV7');</script>
	<!-- End Google Tag Manager -->
	
        <!-- Google Tag Manager -->
        <noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-5RHQV7" height="0" width="0" style="display:none;visibility:hidden" class="optanon-category-C0002"></iframe></noscript>
        <!-- End Google Tag Manager -->	

  
  
  
  

  
      <script type="text/javascript" src="../../_static/js/jquery.min.js"></script>
	  <script type="text/javascript" src="../../_static/js/gtm.js"></script>
  <script type="text/javascript" src="../../_static/js/modernizr.min.js"></script>
    <script type="text/javascript" src="../../_static/js/d3dd8c60ed.js"></script>
    <script type="text/javascript" src="../../_static/js/common-ui-all.min.js"></script>
    <script type="text/javascript" src="../../_static/js/jquery-ui.min.js"></script>
    <script type="text/javascript" src="../../_static/js/CoveoJsSearch.Lazy.min.js"></script>
    <script type="text/javascript" src="../../_static/js/linkid.js"></script>
    <script type="text/javascript" src="../../_static/js/Searchbox.min.js"></script>
    <script type="text/javascript" src="../../_static/js/header-footer.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/css/common-ui-all.min.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/css/header-footer.min.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/css/pro.min.css" media="all" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Multichannel ML" href="Tutorials/MultiChannelML.html" />
    <link rel="prev" title="Platforms And Applications" href="platforms_and_applications.html" /> 
	</head>
	<body>
		<div class="xilinx-bs3"/>
		<div class="root responsivegrid">
			<div class="aem-Grid aem-Grid--16 aem-Grid--default--16 aem-Grid--large--16 aem-Grid--xlarge--16 aem-Grid--xxlarge--16 aem-Grid--xxxlarge--16 ">
 <div class="xilinxExperienceFragments experiencefragment aem-GridColumn aem-GridColumn--default--12">

    
    

    



<div class="xf-content-height">
    

<div class="aem-Grid aem-Grid--16 aem-Grid--default--16 ">
    
    <div class="header parbase aem-GridColumn aem-GridColumn--default--12"><noindex>
	<header data-component="header" class="site-header">
		<nav class="navbar navbar-default">
			<div class="container-fluid main-nav">
				<div class="row">
					<div class="navbar-column col-xs-4 col-sm-5">
						<ul class="nav navbar-nav hidden-xs">
							<li>
									<button onclick="window.location.href=&#39;https://www.xilinx.com/applications.html&#39;;">Solutions</button>
								</li>
							<li>
									<button onclick="window.location.href=&#39;https://www.xilinx.com/products/silicon-devices.html&#39;;">Products</button>
								</li>
							<li>
									<button onclick="window.location.href=&#39;https://www.xilinx.com/about/company-overview.html&#39;;">Company</button>
								</li>
							</ul>
							
						<ul class="nav navbar-nav hidden-sm hidden-md hidden-lg">
							<li>
									<button data-target="#header-container-0" data-function="toggle">Solutions</button>
								</li>
							<li>
									<button data-target="#header-container-1" data-function="toggle">Products</button>
								</li>
							<li>
									<button data-target="#header-container-2" data-function="toggle">Company</button>
								</li>
							</ul>
							
						<div id="header-container-0" class="menu-container">
								<div class="navbar-nav-container">
									<ul class="nav navbar-nav">
										<li>
												<button onclick="window.location.href=&#39;https://www.xilinx.com/applications.html&#39;;">Solutions</button>
												</li>
										<li>
												<button onclick="window.location.href=&#39;https://www.xilinx.com/products/silicon-devices.html&#39;;">Products</button>
												</li>
										<li>
												<button onclick="window.location.href=&#39;https://www.xilinx.com/about/company-overview.html&#39;;">Company</button>
												</li>
										</ul>
									<button data-function="close-menu">
										<span class="fal fa-times" aria-hidden="true"></span>
									</button>
								</div>
							</div>
							<div id="header-container-1" class="menu-container">
								<div class="navbar-nav-container">
									<ul class="nav navbar-nav">
										<li>
												<button onclick="window.location.href=&#39;https://www.xilinx.com/applications.html&#39;;">Solutions</button>
												</li>
										<li>
												<button onclick="window.location.href=&#39;https://www.xilinx.com/products/silicon-devices.html&#39;;">Products</button>
												</li>
										<li>
												<button onclick="window.location.href=&#39;https://www.xilinx.com/about/company-overview.html&#39;;">Company</button>
												</li>
										</ul>
									<button data-function="close-menu">
										<span class="fal fa-times" aria-hidden="true"></span>
									</button>
								</div>
							</div>
							<div id="header-container-2" class="menu-container">
								<div class="navbar-nav-container">
									<ul class="nav navbar-nav">
										<li>
												<button onclick="window.location.href=&#39;https://www.xilinx.com/applications.html&#39;;">Solutions</button>
												</li>
										<li>
												<button onclick="window.location.href=&#39;https://www.xilinx.com/products/silicon-devices.html&#39;;">Products</button>
												</li>
										<li>
												<button onclick="window.location.href=&#39;https://www.xilinx.com/about/company-overview.html&#39;;">Company</button>
												</li>
										</ul>
									<button data-function="close-menu">
										<span class="fal fa-times" aria-hidden="true"></span>
									</button>
								</div>
							</div>
							</div>
					<div class="logo-column col-xs-4 col-sm-2">
						<div class="logo">
							<a target="_blank" href="https://www.xilinx.com/">
								<img src="https://github.com/Xilinx/Image-Collateral/blob/main/xilinx-header-logo.svg?raw=true" title="Xilinx Inc"/>
							</a>
						</div>
					</div>

				</div>
			</div>
			</nav></header></noindex></div>
		
	
</div>

    
</div>
</div>

<div class="calloutBanner parbase aem-GridColumn--default--none aem-GridColumn aem-GridColumn--offset--default--0 aem-GridColumn--default--16"><div class="callout-banner">
    Xilinx is now a part of <a target="_blank" href="https://www.amd.com/en/corporate/xilinx-acquisition">AMD</a> |  <a target="_blank" href="https://www.amd.com/en/corporate/privacy">Learn More</a>
</div>
</div>
				<div class="parsys aem-GridColumn--xxxlarge--none aem-GridColumn--xlarge--none aem-GridColumn--xxlarge--none aem-GridColumn--default--none aem-GridColumn--offset--large--1 aem-GridColumn--xlarge--12 aem-GridColumn--offset--default--0 aem-GridColumn--xxlarge--10 aem-GridColumn--offset--xlarge--2 aem-GridColumn--offset--xxlarge--3 aem-GridColumn--offset--xxxlarge--4 aem-GridColumn--large--none aem-GridColumn aem-GridColumn--large--14 aem-GridColumn--xxxlarge--8 aem-GridColumn--default--16">
						<div class="container-fluid">
							<div class="row">
							<div class="col-xs-12">
   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html" class="icon icon-home" alt="Documentation Home"> Vitis™ Video Analytics SDK
          

          
          </a>

          
            
            
              <div class="version">
                1.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

      
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
            
            
            
              
            
            
              <p class="caption"><span class="caption-text">Release Notes</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../release_notes.html">Release Notes</a></li>
</ul>
<p class="caption"><span class="caption-text">Base Infrastructure</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../common/common_plugins.html">Plugins</a></li>
<li class="toctree-l1"><a class="reference internal" href="../common/for_developers.html">For Advanced Developers</a></li>
</ul>
<p class="caption"><span class="caption-text">Embedded</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="platforms_and_applications.html">Platforms &amp; Applications</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="platforms_and_applications.html#som-examples">SOM Examples</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="platforms_and_applications.html#zcu104-examples">ZCU104 Examples</a><ul class="current">
<li class="toctree-l3 current"><a class="current reference internal" href="#">Smart Model Select</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#features">Features</a></li>
<li class="toctree-l4"><a class="reference internal" href="#prerequisites">Prerequisites</a></li>
<li class="toctree-l4"><a class="reference internal" href="#preparing-the-setup">Preparing the setup</a></li>
<li class="toctree-l4"><a class="reference internal" href="#running-the-application">Running the application</a></li>
<li class="toctree-l4"><a class="reference internal" href="#build-design">Build Design</a></li>
<li class="toctree-l4"><a class="reference internal" href="#compiling-hardware-accelerators-kernels">Compiling Hardware Accelerators (Kernels)</a></li>
<li class="toctree-l4"><a class="reference internal" href="#creating-sd-card-image">Creating SD Card image</a></li>
<li class="toctree-l4"><a class="reference internal" href="#build-vvas-plug-ins-and-libraries">Build VVAS Plug-ins and Libraries</a></li>
<li class="toctree-l4"><a class="reference internal" href="#known-issues">Known Issues</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="Tutorials/MultiChannelML.html">Multi Channel ML</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="6-embedded-plugins.html">Plugins</a></li>
<li class="toctree-l1"><a class="reference internal" href="Tutorials/Tutorials.html">Tutorials</a></li>
</ul>
<p class="caption"><span class="caption-text">Data Center</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../DC/platforms_and_applications.html">Platforms &amp; Applications</a></li>
<li class="toctree-l1"><a class="reference internal" href="../DC/6-DC-plugins.html">Plugins</a></li>
</ul>
<p class="caption"><span class="caption-text">FAQ</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../freq_asked_questions.html">Frequently Asked Questions</a></li>
</ul>

            
			
			<p class="caption"><span class="caption-text">This Page</span></p>
				<ul class="current">
				  <li class="toctree-l1"><a href="../../_sources/docs/Embedded/smart_model_select.rst.txt"
						rel="nofollow">Show Source</a></li>
				</ul>
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Vitis™ Video Analytics SDK</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="platforms_and_applications.html">Platforms And Applications</a> &raquo;</li>
        
      <li>Smart Model Select</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../_sources/docs/Embedded/smart_model_select.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="smart-model-select">
<h1>Smart Model Select<a class="headerlink" href="#smart-model-select" title="Permalink to this headline">¶</a></h1>
<p>Smart Model Select is an example application to demonstrate inferencing using 16 Machine Learning (ML) models supported by VVAS. User can select the input source, ML model to be used and the output option, like display on monitor or dump the results to file.</p>
<p>Smart Model Select application design is built on <code class="docutils literal notranslate"><span class="pre">zcu104</span></code> development board which, along with VVAS, provides a complete framework for building and customizing video platforms with different pipelines stages. <code class="docutils literal notranslate"><span class="pre">zcu104</span></code> development board can support below mentioned pipeline stages:</p>
<ul class="simple">
<li><p>Capture Pipelines</p></li>
<li><p>Video Processing Pipelines</p></li>
<li><p>Acceleration Pipelines</p></li>
<li><p>Output Pipelines</p></li>
</ul>
<p>Smart Model Select design doesn’t support Capture Pipeline.</p>
<div class="section" id="features">
<h2>Features<a class="headerlink" href="#features" title="Permalink to this headline">¶</a></h2>
<p>Smart Model Select application supports below mentioned features</p>
<ul class="simple">
<li><p>Supports 16 ML Models</p>
<ul>
<li><p>resnet50</p></li>
<li><p>resnet18</p></li>
<li><p>mobilenet_v2</p></li>
<li><p>inception_v1</p></li>
<li><p>ssd_adas_pruned_0_95</p></li>
<li><p>ssd_traffic_pruned_0_9</p></li>
<li><p>ssd_mobilenet_v2</p></li>
<li><p>ssd_pedestrian_pruned_0_97</p></li>
<li><p>plate_detect</p></li>
<li><p>yolov3_voc_tf</p></li>
<li><p>yolov3_adas_pruned_0_9</p></li>
<li><p>refinedet_pruned_0_96</p></li>
<li><p>yolov2_voc</p></li>
<li><p>yolov2_voc_pruned_0_77</p></li>
<li><p>densebox_320_320</p></li>
<li><p>densebox_640_360</p></li>
</ul>
</li>
<li><p>Display Port for display</p></li>
<li><p>H264/H265 Decode</p></li>
<li><p>Input can be from file or rtsp source</p></li>
</ul>
</div>
<div class="section" id="prerequisites">
<h2>Prerequisites<a class="headerlink" href="#prerequisites" title="Permalink to this headline">¶</a></h2>
<p>Before attempting the execution of application, please ensure that all the pre-requisites mentioned below are fulfilled.</p>
<div class="section" id="hardware-requirements">
<h3>Hardware Requirements<a class="headerlink" href="#hardware-requirements" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p><a class="reference external" href="https://www.xilinx.com/products/boards-and-kits/zcu104.html">ZCU104 Evaluation Board Rev 1.0</a></p></li>
<li><p>Micro USB cable, connected to laptop or desktop computer for the terminal emulator</p></li>
<li><p>Micro SD card, 8 GB or larger, class 10 (recommended)</p></li>
<li><p>Display port 1.2 supported Monitor with 1920x1080 as max resolution</p></li>
<li><p>Display port 1.2 cable</p></li>
</ul>
</div>
<div class="section" id="software-tools-requirements">
<h3>Software/Tools Requirements<a class="headerlink" href="#software-tools-requirements" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>Serial terminal emulator (for example, Tera Term)</p></li>
<li><p>Balena etcher or equivalent flashing tool to flash the SD Card image</p></li>
</ul>
</div>
<div class="section" id="system-requirements">
<h3>System Requirements<a class="headerlink" href="#system-requirements" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>Board must have access to the internet and be accessible from your development system</p></li>
</ul>
</div>
<div class="section" id="application-design">
<h3>Application Design<a class="headerlink" href="#application-design" title="Permalink to this headline">¶</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">Smart</span> <span class="pre">Model</span> <span class="pre">Select</span></code> application design has a platform and integrated accelerator functions.
Platform is nothing but collection of hardware as well as software components required to build a solution.
Prebuilt design for <code class="docutils literal notranslate"><span class="pre">Smart</span> <span class="pre">Model</span> <span class="pre">Select</span></code> has been provided as part of this VVAS release.
You may download this ready to use design by following the link <a class="reference internal" href="#prebuilt-binaries"><span class="std std-ref">Download pre-built binaries</span></a> and
directly jump to <a class="reference internal" href="#preparing-setup"><span class="std std-ref">Preparing Setup</span></a> section describing how to prepare the setup and execute the example application.</p>
<p>If for some reason, one wants to build the design from scratch, then refer to the section <a class="reference internal" href="#build-platform"><span class="std std-ref">Build Design</span></a> that describes the steps to build the platform, accelerator functions and finally integrate these to create complete Design for <cite>Smart Model Select</cite> application.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>VVAS platform <code class="docutils literal notranslate"><span class="pre">zcu104_vcuDec_DP</span></code> may not be performance optimal. This platform is made available as reference along with <cite>Smart Model Select Application</cite>.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>VVAS platform <code class="docutils literal notranslate"><span class="pre">zcu104_vcuDec_DP</span></code> adds patch to irps5401 driver for zcu104 board to support multi thread execution of VAI models.
This <a class="reference external" href="https://github.com/Xilinx/Vitis-AI/tree/master/dsa/DPU-TRD/app/dpu_sw_optimize.tar.gz">patch</a> shouldn’t be applied to other boards
and is not part of the official Xilinx released 2021.2 Petalinux.</p>
</div>
</div>
<div class="section" id="pre-built-binaries">
<span id="prebuilt-binaries"></span><h3>Pre-built binaries<a class="headerlink" href="#pre-built-binaries" title="Permalink to this headline">¶</a></h3>
<p>Ready to use Prebuilt binaries are provided with this VVAS release. You can download these binaries and required supporting files to quickly run the example application.</p>
<p>Create a folder, say <cite>PREBUILT_BINARIES</cite>, where pre-built binaries are to be downloaded.</p>
<p>Click on <a class="reference external" href="https://www.xilinx.com/member/forms/download/xef.html?filename=vvas_smart_model_select_2021.2_zcu104.zip">Smart Model Select Prebuilt Binaries</a>. This will ask for few credentials and then start downloading.</p>
<p>Unzip the downloaded package <cite>vvas_smart_model_select_2021.2_zcu104.zip</cite>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">unzip</span> <span class="n">vvas_smart_model_select_2021</span><span class="mf">.2</span><span class="n">_zcu104</span><span class="o">.</span><span class="n">zip</span>
</pre></div>
</div>
<p>Prebuilt binaries package includes</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">sd_card.img</span></code>: Image to be flashed on the SD Card on the zcu104 board.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">sdk.sh</span></code>: This is required to generate sysroot. Sysroot is required  <strong>only</strong> if one wants to build the VVAS plugins and
libraries. You do not need this if you simply want to execute the pre-built application.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">models</span></code>: Supported DPU models on this platform.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">app</span></code>: Contains application executable and input configuration/json files.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">arch.json</span></code>: Represents DPU architecture.</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The pre-buit binaries available for download from the link  mentioned above contain software copyrighted by Xilinx and third parties subject to one or more open source software licenses that are contained in the source code files available for download at the link mentioned below.  Please see the source code for the copyright notices and licenses applicable to the software in these binary files.  By downloading these binary files, you agree to abide by the licenses contained in the corresponding source code</p>
</div>
<div class="section" id="open-source-licenses-and-source-code-vvas-1-1">
<h4>Open Source Licenses and Source code - VVAS 1.1<a class="headerlink" href="#open-source-licenses-and-source-code-vvas-1-1" title="Permalink to this headline">¶</a></h4>
<p>In case user wants to see the Licenses and source code that was used to build these pre-built binaries, download <a class="reference external" href="https://www.xilinx.com/member/forms/download/xef.html?filename=vvas_rel_1_1_thirdparty_sources.zip">Source Licenses and Source Code</a> that contain the Open Source Licenses and source code.</p>
<p>Once you have downloaded the prebuilt binaries, you need to prepare the setup to execute the application, as shown in the next section.</p>
</div>
</div>
</div>
<div class="section" id="preparing-the-setup">
<span id="preparing-setup"></span><h2>Preparing the setup<a class="headerlink" href="#preparing-the-setup" title="Permalink to this headline">¶</a></h2>
<p>It is assumed that all the pre-requisites are fulfilled and we are ready to setup the board and execute the example application. There are few steps that are required only for the first time when the <code class="docutils literal notranslate"><span class="pre">zcu104</span></code> board is not flashed with the sd_card image for <code class="docutils literal notranslate"><span class="pre">smart_model_select</span></code> application. You may skip these steps if <code class="docutils literal notranslate"><span class="pre">zcu104</span></code> board has already been flashed with the required sd_card image.</p>
<div class="section" id="one-time-setup">
<h3>One time setup<a class="headerlink" href="#one-time-setup" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p>Flash the SD Card with the <code class="docutils literal notranslate"><span class="pre">sd_card.img</span></code> using any SD card flashing tool like dd, Win32DiskImager, or BalenaEtcher.</p>
<p>If using pre-built binaries, then sd_card.img is located as</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">PREBUILT_BINARIES</span><span class="o">&gt;/</span><span class="n">vvas_smart_model_select_2021</span><span class="mf">.2</span><span class="n">_zcu104</span><span class="o">/</span><span class="n">sd_card</span><span class="o">.</span><span class="n">img</span>
</pre></div>
</div>
<p>If you have built the platform yourself, then sd_card.img would be located at</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">VVAS_SOURCES</span><span class="o">&gt;/</span><span class="n">VVAS</span><span class="o">/</span><span class="n">vvas</span><span class="o">-</span><span class="n">examples</span><span class="o">/</span><span class="n">Embedded</span><span class="o">/</span><span class="n">smart_model_select</span><span class="o">/</span><span class="n">binary_container_1</span><span class="o">/</span><span class="n">sd_card</span><span class="o">.</span><span class="n">img</span>
</pre></div>
</div>
</li>
<li><p>Insert this SD card in the SD card slot on the zcu104 board and boot the board.</p></li>
<li><p>After booting up the board, run below command to extend the root filesystem partition to its 100% size. This is useful
in copying input video streams and storing output files from example application.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">resize</span><span class="o">-</span><span class="n">part</span> <span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">mmcblk0p2</span>
</pre></div>
</div>
</li>
<li><p>Copy the <cite>&lt;PREBUILT_BINARIES&gt;/vvas_smart_model_select_2021.2_zcu104/app</cite> folder of the application onto <cite>home</cite> folder of the board.
.. code-block:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">scp</span> <span class="o">-</span><span class="n">r</span> <span class="o">&lt;</span><span class="n">PREBUILT_BINARIES</span><span class="o">&gt;/</span><span class="n">vvas_smart_model_select_2021</span><span class="mf">.2</span><span class="n">_zcu104</span><span class="o">/</span><span class="n">app</span> <span class="n">root</span><span class="o">@&lt;</span><span class="n">board</span> <span class="n">ip</span><span class="o">&gt;</span><span class="p">:</span><span class="o">~/</span>
</pre></div>
</div>
</li>
<li><p>After copying, <code class="docutils literal notranslate"><span class="pre">chmod</span></code> <cite>~/app/setup.sh</cite> and <cite>~/app/smart_model_select</cite> to make them executable on the board.
.. code-block:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">chmod</span> <span class="mi">777</span> <span class="o">~/</span><span class="n">app</span><span class="o">/</span><span class="n">smart_model_select</span>
<span class="n">chmod</span> <span class="mi">777</span> <span class="o">~/</span><span class="n">app</span><span class="o">/</span><span class="n">setup</span><span class="o">.</span><span class="n">sh</span>
</pre></div>
</div>
</li>
<li><p>Create <cite>/usr/share/vitis_ai_library/models</cite> folder on the board and copy the Vitis-AI models into it:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mkdir</span> <span class="o">-</span><span class="n">p</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">share</span><span class="o">/</span><span class="n">vitis_ai_library</span><span class="o">/</span><span class="n">models</span>
<span class="n">scp</span> <span class="o">-</span><span class="n">r</span> <span class="o">&lt;</span><span class="n">PREBUILT_BINARIES</span><span class="o">&gt;/</span><span class="n">vvas_smart_model_select_2021</span><span class="mf">.2</span><span class="n">_zcu104</span><span class="o">/</span><span class="n">models</span><span class="o">/*</span> <span class="n">root</span><span class="o">@&lt;</span><span class="n">board</span> <span class="n">ip</span><span class="o">&gt;/</span><span class="n">usr</span><span class="o">/</span><span class="n">share</span><span class="o">/</span><span class="n">vitis_ai_library</span><span class="o">/</span><span class="n">models</span><span class="o">/</span>
</pre></div>
</div>
</li>
</ul>
</div>
</div>
<div class="section" id="running-the-application">
<h2>Running the application<a class="headerlink" href="#running-the-application" title="Permalink to this headline">¶</a></h2>
<p>This section will elaborate on the usage of the application and various options with it.</p>
<p>Every time the board is booted, execute the steps mentioned below</p>
<ul>
<li><p>Run <cite>setup.sh</cite> on the board, this will set the alpha channel of the display port and copy label json files related
to each model.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cd</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">root</span><span class="o">/</span><span class="n">app</span><span class="o">/</span>
<span class="o">./</span><span class="n">setup</span><span class="o">.</span><span class="n">sh</span>
</pre></div>
</div>
</li>
<li><p>Export the environment variable “XCLBIN_PATH” with path pointing to xclbin. If it’s not exported, <cite>/media/sd-mmcblk0p1/dpu.xclbin</cite> will be the default xclbin path.</p></li>
<li><p>Run the command to execute the application
.. code-block:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">./</span><span class="n">smart_model_select</span>
</pre></div>
</div>
</li>
</ul>
<p>When the application starts executing, you can observe the Fig 1 coming up in the display. This menu displays various models supported by the application and options on either side of the image are for input sources and output sinks supported. All these options carry an index number alongside, which user need to enter in sequence to create the pipeline of choice.</p>
<img alt="../../_images/ExampleAppMenu.png" src="../../_images/ExampleAppMenu.png" />
<p>Fig 1: Menu image of the application</p>
<p>Below command line prompt will appear on console/command prompt when the application starts, which will accept the input options for creating the GStreamer pipeline of choice. As described below, user must enter four options in the sequence of input source, ML model to be used, output sink and a field to enable/disable performance mode. Example the sequence “1,2,3,0”, tells that the source is “filesrc”, ML model to be used is “resnet18”, sink is “kmssink” and 0 is to disable performance mode.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX</span>
<span class="n">Menu</span> <span class="n">displayed</span> <span class="n">on</span> <span class="n">the</span> <span class="n">monitor</span> <span class="n">shows</span> <span class="n">various</span> <span class="n">options</span> <span class="n">available</span>
<span class="k">for</span> <span class="nb">input</span> <span class="n">source</span><span class="p">,</span> <span class="n">ML</span> <span class="n">model</span><span class="p">,</span> <span class="n">output</span> <span class="n">sink</span><span class="o">.</span> <span class="n">Each</span> <span class="n">option</span> <span class="n">carries</span> <span class="n">an</span>
<span class="n">index</span> <span class="n">number</span> <span class="n">alongside</span><span class="o">.</span>
<span class="n">Select</span> <span class="n">elements</span> <span class="n">to</span> <span class="n">be</span> <span class="n">used</span> <span class="ow">in</span> <span class="n">the</span> <span class="n">pipeline</span> <span class="ow">in</span> <span class="n">the</span> <span class="n">sequence</span> <span class="n">of</span>
<span class="s2">&quot;input source, ML model, output sink and performance</span>
<span class="n">mode</span> <span class="n">flag</span><span class="s2">&quot; separated by commas.</span>
<span class="n">e</span><span class="o">.</span><span class="n">g</span><span class="o">.</span> <span class="nb">input</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">0</span>
<span class="n">Above</span> <span class="nb">input</span> <span class="n">will</span> <span class="n">run</span> <span class="s2">&quot;filesrc&quot;</span> <span class="nb">input</span><span class="p">,</span> <span class="s2">&quot;resnet50&quot;</span> <span class="n">model</span>
<span class="s2">&quot;kmssink&quot;</span> <span class="n">used</span> <span class="k">as</span> <span class="n">output</span> <span class="n">sink</span> <span class="ow">and</span> <span class="n">performance</span> <span class="n">mode</span> <span class="n">disabled</span><span class="o">.</span>
<span class="n">Enter</span> <span class="s1">&#39;q&#39;</span> <span class="n">to</span> <span class="n">exit</span>
<span class="n">XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If performance mode is enabled, then the sink type should always be <code class="docutils literal notranslate"><span class="pre">fakesink</span></code>. Otherwise pipeline will not execute.</p>
<p>If performance mode is enabled, there will be 4 ML pipelines executed simultaneously feeding DPU from multiple threads. This results in improved performance compared to when using DPU from single thread.</p>
<p>In the GStreamer pipelines in this application, Sync is disabled. Which means frames are sent to the display at the rate at which these are processed by pipeline. Hence for smaller resolution streams, you may observe that frames are displayed at faster than real time rate
.</p>
</div>
<p>Followed by the selection of ML model, source and sink elements, next step is the option to provide input filename or RTSP URL as applicable, to be processed.</p>
<p>If the selected input is file source, then by default application will look for the input video files under <cite>app/videos</cite> folder.
Create the folder <code class="docutils literal notranslate"><span class="pre">/home/root/app/videos</span></code> and copy the video files here with names given below.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">videos</span><span class="o">/</span>
<span class="o">+--</span> <span class="n">CLASSIFICATION</span><span class="o">.</span><span class="n">mp4</span>
<span class="o">+--</span> <span class="n">FACEDETECT</span><span class="o">.</span><span class="n">mp4</span>
<span class="o">+--</span> <span class="n">PLATEDETECT</span><span class="o">.</span><span class="n">mp4</span>
<span class="o">+--</span> <span class="n">REFINEDET</span><span class="o">.</span><span class="n">mp4</span>
<span class="o">+--</span> <span class="n">SSD</span><span class="o">.</span><span class="n">mp4</span>
<span class="o">+--</span> <span class="n">YOLOV2</span><span class="o">.</span><span class="n">mp4</span>
<span class="o">+--</span> <span class="n">YOLOV3</span><span class="o">.</span><span class="n">mp4</span>
</pre></div>
</div>
<p>If the file is not available in this folder then application will prompt for the input file. All files must be named after ML model type as given below.
User has to enter the input file location in response to the below message prompt.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Enter</span> <span class="n">the</span> <span class="nb">input</span> <span class="n">filename</span> <span class="n">to</span> <span class="n">be</span> <span class="n">processed</span>
</pre></div>
</div>
<p>If the selected input source is “RTSP”, then application will prompt for entering “RTSP” URL.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Enter</span> <span class="n">the</span> <span class="n">RTSP</span> <span class="n">url</span> <span class="n">to</span> <span class="n">be</span> <span class="n">processed</span>
</pre></div>
</div>
<p>The application supports RTSP input with RTP packets containing H264 payload of resolution 1920x1080. One can download and setup GStreamer RTSP server or VLC can also be used to serve RTSP data. Follow below steps to compile GStreamer RTSP server. For successful compilation of GStreamer RTSP server, GStreamer framework must be installed as a prerequisite.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mf">1.</span>  <span class="n">wget</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">gstreamer</span><span class="o">.</span><span class="n">freedesktop</span><span class="o">.</span><span class="n">org</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">gst</span><span class="o">-</span><span class="n">rtsp</span><span class="o">-</span><span class="n">server</span><span class="o">/</span><span class="n">gst</span><span class="o">-</span><span class="n">rtsp</span><span class="o">-</span><span class="n">server</span><span class="o">-</span><span class="mf">1.16.2</span><span class="o">.</span><span class="n">tar</span><span class="o">.</span><span class="n">xz</span>
<span class="mf">2.</span>  <span class="n">tar</span> <span class="o">-</span><span class="n">xvf</span> <span class="n">gst</span><span class="o">-</span><span class="n">rtsp</span><span class="o">-</span><span class="n">server</span><span class="o">-</span><span class="mf">1.16.2</span><span class="o">.</span><span class="n">tar</span><span class="o">.</span><span class="n">xz</span>
<span class="mf">3.</span>  <span class="n">cd</span> <span class="n">gst</span><span class="o">-</span><span class="n">rtsp</span><span class="o">-</span><span class="n">server</span><span class="o">-</span><span class="mf">1.16.2</span><span class="o">/</span>
<span class="mf">4.</span>  <span class="o">./</span><span class="n">autogen</span><span class="o">.</span><span class="n">sh</span> <span class="o">--</span><span class="n">disable</span><span class="o">-</span><span class="n">gtk</span><span class="o">-</span><span class="n">doc</span>
<span class="mf">5.</span>  <span class="n">make</span>
</pre></div>
</div>
<p>Examples in gst-rtsp-server-1.16.2/examples can be used to serve RTSP data. Refer below example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cd</span> <span class="n">gst</span><span class="o">-</span><span class="n">rtsp</span><span class="o">-</span><span class="n">server</span><span class="o">-</span><span class="mf">1.16.2</span><span class="o">/</span><span class="n">examples</span>
<span class="o">./</span><span class="n">test</span><span class="o">-</span><span class="n">launch</span>  <span class="s2">&quot;filesrc location=&lt;Absolute Path of File with H264 1080p in MP4 format&gt; ! qtdemux  ! h264parse ! rtph264pay name=pay0 pt=96&quot;</span>
</pre></div>
</div>
<p>Streaming starts on the URL <a class="reference external" href="rtsp:/">rtsp:/</a>/&lt;RTSP server ip adress&gt;:8554/test. Enter the same URL as input to the application.</p>
<p>Application supports multiple sink options as well. If <code class="docutils literal notranslate"><span class="pre">kmssink</span></code> is used, output video will be rendered on the display monitor connected. If <code class="docutils literal notranslate"><span class="pre">filesink</span></code> is chosen, the output will get dumped to a file by name “output.nv12” in the current directory. On the other hand, <code class="docutils literal notranslate"><span class="pre">fakesink</span></code> acts a black hole for the data with no overhead.</p>
<p>Below Fig 2 is the pictorial depiction of a typical pipeline that is created by the application.</p>
<img alt="../../_images/ExamplePipeline.png" src="../../_images/ExamplePipeline.png" />
<p>Fig 2: Typical GStreamer pipeline that application creates</p>
</div>
<div class="section" id="build-design">
<span id="build-platform"></span><h2>Build Design<a class="headerlink" href="#build-design" title="Permalink to this headline">¶</a></h2>
<p>The Design consists of a base platform and integrated accelerator functions (Kernels).</p>
<div class="section" id="base-platform">
<h3>Base Platform<a class="headerlink" href="#base-platform" title="Permalink to this headline">¶</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">Smart</span> <span class="pre">Model</span> <span class="pre">Select</span></code> application requires video decoding, resizing the decoded frames, Machine Learning and finally display the output. Hence, we need a platform that fulfills these requirement. This VVAS release has <code class="docutils literal notranslate"><span class="pre">zcu104_vcuDec_DP</span></code> base platform that meets the requirements of decode and display. This platform has hardware accelerated video decoding IP, Video Codec Unit <code class="docutils literal notranslate"><span class="pre">VCU</span></code>. For display, this platform supports <code class="docutils literal notranslate"><span class="pre">Display</span> <span class="pre">Port</span></code>. The design also include two DPU 4096 cores for Machine Learning.</p>
<p>In addition to the above-mentioned hardware components, <code class="docutils literal notranslate"><span class="pre">zcu104_vcuDec_DP</span></code> supports following software components</p>
<ul class="simple">
<li><p>omxh264dec GStreamer plugin</p></li>
<li><p>Opensource framework like GStreamer, OpenCV</p></li>
<li><p>Vitis AI 2.0 libraries</p></li>
<li><p>Xilinx Run Time (XRT)</p></li>
</ul>
</div>
<div class="section" id="compiling-base-platform">
<h3>Compiling base platform<a class="headerlink" href="#compiling-base-platform" title="Permalink to this headline">¶</a></h3>
<p>Complete sources along with workspace to build the platform is provided as part of this release.
Follow the steps mentioned below to compile the platform.</p>
<ol class="arabic">
<li><p>Navigate to the folder, such as <code class="docutils literal notranslate"><span class="pre">VVAS_SOURCES</span></code>,  where you want to clone the VVAS source tree.</p></li>
<li><p>Clone VVAS repo:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">git</span> <span class="n">clone</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">github</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">Xilinx</span><span class="o">/</span><span class="n">VVAS</span><span class="o">.</span><span class="n">git</span>
</pre></div>
</div>
</li>
<li><p>Setup tool chain environment:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">source</span> <span class="o">&lt;</span><span class="mf">2021.2</span><span class="n">_Vitis</span><span class="o">&gt;/</span><span class="n">settings64</span><span class="o">.</span><span class="n">sh</span>
<span class="n">source</span> <span class="o">&lt;</span><span class="mf">2021.2</span><span class="n">_Petalinux</span><span class="o">&gt;/</span><span class="n">settings</span><span class="o">.</span><span class="n">sh</span>
<span class="n">source</span> <span class="o">&lt;</span><span class="mf">2021.2</span><span class="n">_XRT</span><span class="o">&gt;/</span><span class="n">setenv</span><span class="o">.</span><span class="n">sh</span>
</pre></div>
</div>
</li>
<li><p>Navigate to <code class="docutils literal notranslate"><span class="pre">zcu104_vcuDec_DP</span></code> platform folder:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cd</span> <span class="o">&lt;</span><span class="n">VVAS_SOURCES</span><span class="o">&gt;/</span><span class="n">VVAS</span><span class="o">/</span><span class="n">vvas</span><span class="o">-</span><span class="n">platforms</span><span class="o">/</span><span class="n">Embedded</span><span class="o">/</span><span class="n">zcu104_vcuDec_DP</span>
</pre></div>
</div>
</li>
<li><p>Compile the platform:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">make</span>
</pre></div>
</div>
</li>
</ol>
<p id="platform-path">After build is finished, platform will be available <code class="docutils literal notranslate"><span class="pre">&lt;VVAS_SOURCES&gt;/VVAS/vvas-platforms/Embedded/zcu104_vcuDec_DP/platform_repo/xilinx_zcu104_vcuDec_DP_202120_1/export/xilinx_zcu104_vcuDec_DP_202120_1/</span></code> location.</p>
</div>
<div class="section" id="hardware-accelerators-kernels">
<h3>Hardware Accelerators (Kernels)<a class="headerlink" href="#hardware-accelerators-kernels" title="Permalink to this headline">¶</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">Smart</span> <span class="pre">Model</span> <span class="pre">Select</span></code> application’s requirements of Machine Learning and Resize operations are fulfilled by below mentioned accelerators (Kernels):</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">DPU</span></code> (Deep Learning Processing Unit) for Machine Learning.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Multiscaler</span></code> for Preprocessing operation</p></li>
</ul>
</div>
</div>
<div class="section" id="compiling-hardware-accelerators-kernels">
<h2>Compiling Hardware Accelerators (Kernels)<a class="headerlink" href="#compiling-hardware-accelerators-kernels" title="Permalink to this headline">¶</a></h2>
<p>The sources for hardware accelerators required for <code class="docutils literal notranslate"><span class="pre">Smart</span> <span class="pre">Model</span> <span class="pre">Select</span></code> application can be made available as mentioned below:</p>
<ol class="arabic">
<li><p>Navigate to &lt;VVAS_SOURCES&gt;</p></li>
<li><p>DPU Kernel sources can be cloned from:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">git</span> <span class="n">clone</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">github</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">Xilinx</span><span class="o">/</span><span class="n">Vitis</span><span class="o">-</span><span class="n">AI</span><span class="o">.</span><span class="n">git</span>
<span class="n">cd</span> <span class="n">Vitis</span><span class="o">-</span><span class="n">AI</span><span class="o">/</span>
<span class="n">git</span> <span class="n">checkout</span> <span class="n">tags</span><span class="o">/</span><span class="n">v2</span><span class="mf">.0</span> <span class="o">-</span><span class="n">b</span> <span class="n">v2</span><span class="mf">.0</span>
</pre></div>
</div>
</li>
<li><p>Multiscaler kernel sources are part of VVAS source tree and are located at:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">VVAS_SOURCES</span><span class="o">&gt;/</span><span class="n">VVAS</span><span class="o">/</span><span class="n">vvas</span><span class="o">-</span><span class="n">accel</span><span class="o">-</span><span class="n">hw</span><span class="o">/</span><span class="n">multiscaler</span>
</pre></div>
</div>
</li>
</ol>
<p>Kernels may have different configurations for different application requirements. Hence it is recommended to build the Kernels from the application design workspace with the required Kernel configuration for that application.</p>
<p>Each application design workspace provided with this VVAS release has the required Kernel configurations for that application.</p>
<p>In case one wants to change the kernel configuration for some reason, do these changes in the configuration files mentioned below.</p>
<p>Compilation of Kernels is initiated from the build process of the final design for the application. Hence kernel compilation steps are not covered separately here.</p>
<ul>
<li><p>Configuration of DPU:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">VVAS_SOURCES</span><span class="o">&gt;/</span><span class="n">VVAS</span><span class="o">/</span><span class="n">vvas</span><span class="o">-</span><span class="n">examples</span><span class="o">/</span><span class="n">Embedded</span><span class="o">/</span><span class="n">smart_model_select</span><span class="o">/</span><span class="n">dpu_conf</span><span class="o">.</span><span class="n">vh</span>
</pre></div>
</div>
</li>
<li><p>Configuration of Multiscaler:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">VVAS_SOURCES</span><span class="o">&gt;/</span><span class="n">VVAS</span><span class="o">/</span><span class="n">vvas</span><span class="o">-</span><span class="n">examples</span><span class="o">/</span><span class="n">Embedded</span><span class="o">/</span><span class="n">smart_model_select</span><span class="o">/</span><span class="n">v_multi_scaler_config</span><span class="o">.</span><span class="n">h</span>
</pre></div>
</div>
</li>
</ul>
<p>You may modify the kernel configuration as per your requirements in these files.</p>
</div>
<div class="section" id="creating-sd-card-image">
<h2>Creating SD Card image<a class="headerlink" href="#creating-sd-card-image" title="Permalink to this headline">¶</a></h2>
<p>Once platform is available and kernels are built, next step is to stitch the required hardware accelerators (kernels) into the platform and generate final SD Card image using Vitis Flow.</p>
<p>VVAS sources already has ready to build example Vitis workspace for <code class="docutils literal notranslate"><span class="pre">smart_model_select</span></code> Application. This workspace uses Vitis Flow that stitches kernels into the platform and generates final SD card image. Follow below mentioned steps to build the final image.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cd</span> <span class="o">&lt;</span><span class="n">VVAS_SOURCES</span><span class="o">&gt;/</span><span class="n">VVAS</span><span class="o">/</span><span class="n">vvas</span><span class="o">-</span><span class="n">examples</span><span class="o">/</span><span class="n">Embedded</span><span class="o">/</span><span class="n">smart_model_select</span>
<span class="n">make</span> <span class="n">PLATFORM</span><span class="o">=&lt;</span><span class="n">PLATFORM_PATH</span> <span class="o">&gt;</span> <span class="n">DPU_TRD_PATH</span><span class="o">=&lt;</span><span class="n">DPU_PATH</span><span class="o">&gt;</span> <span class="n">HW_ACCEL_PATH</span><span class="o">=&lt;</span><span class="n">MULTISCALER_PATH</span><span class="o">&gt;</span>

<span class="n">PLATFORM_PATH</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">VVAS_SOURCES</span><span class="o">&gt;/</span><span class="n">VVAS</span><span class="o">/</span><span class="n">vvas</span><span class="o">-</span><span class="n">platforms</span><span class="o">/</span><span class="n">Embedded</span><span class="o">/</span><span class="n">zcu104_vcuDec_DP</span><span class="o">/</span><span class="n">platform_repo</span><span class="o">/</span><span class="n">xilinx_zcu104_vcuDec_DP_202120_1</span><span class="o">/</span><span class="n">export</span><span class="o">/</span><span class="n">xilinx_zcu104_vcuDec_DP_202120_1</span><span class="o">/</span><span class="n">xilinx_zcu104_vcuDec_DP_202120_1</span><span class="o">.</span><span class="n">xpfm</span>
<span class="n">DPU_PATH</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">VVAS_SOURCES</span><span class="o">&gt;/</span><span class="n">Vitis</span><span class="o">-</span><span class="n">AI</span><span class="o">/</span><span class="n">dsa</span><span class="o">/</span><span class="n">DPU</span><span class="o">-</span><span class="n">TRD</span><span class="o">/</span>
<span class="n">MULTISCALER_PATH</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">VVAS_SOURCES</span><span class="o">&gt;/</span><span class="n">VVAS</span><span class="o">/</span><span class="n">vvas</span><span class="o">-</span><span class="n">accel</span><span class="o">-</span><span class="n">hw</span>
</pre></div>
</div>
<p>Once above build is done, final sdcard image is available at <code class="docutils literal notranslate"><span class="pre">./binary_container_1/sd_card.img</span></code> location.</p>
</div>
<div class="section" id="build-vvas-plug-ins-and-libraries">
<span id="build-vvas-plugins-and-libs"></span><h2>Build VVAS Plug-ins and Libraries<a class="headerlink" href="#build-vvas-plug-ins-and-libraries" title="Permalink to this headline">¶</a></h2>
<p>VVAS Plugins and libraries are part of petalinux bsp and are built along with building platform. So, no need to build again. Still if one wants to build these for some reason, follow the steps mentioned below,</p>
<div class="section" id="setting-sysroot">
<h3>Setting Sysroot<a class="headerlink" href="#setting-sysroot" title="Permalink to this headline">¶</a></h3>
<p>Sysroot is required to build the VVAS GStreamer plugins. Sysroot installer location depends on whether you are using pre-built binaries, or you have built the platform from scratch.</p>
<p>If you have downloaded the pre-built binaries in folder, say <code class="docutils literal notranslate"><span class="pre">PREBUILT_BINARIES</span></code>, then you can find the Sysroot installer at:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">PREBUILT_BINARIES</span><span class="o">&gt;/</span><span class="n">vvas_smart_model_select_2021</span><span class="mf">.2</span><span class="n">_zcu104</span><span class="o">/</span><span class="n">sdk</span><span class="o">.</span><span class="n">sh</span>
</pre></div>
</div>
<p>If you have built the platform yourself, then Sysroot installer is available at:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">VVAS_SOURCES</span><span class="o">&gt;/</span><span class="n">VVAS</span><span class="o">/</span><span class="n">vvas</span><span class="o">-</span><span class="n">platforms</span><span class="o">/</span><span class="n">Embedded</span><span class="o">/</span><span class="n">zcu104_vcuDec_DP</span><span class="o">/</span><span class="n">platform_repo</span><span class="o">/</span><span class="n">tmp</span><span class="o">/</span><span class="n">sw_components</span><span class="o">/</span><span class="n">sdk</span><span class="o">.</span><span class="n">sh</span>
</pre></div>
</div>
<p>One need to install the sysroot. Create a folder, say <strong>sysroot</strong> in <cite>VVAS_SOURCES</cite>. Command for sysroot generation is:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">path</span> <span class="n">to</span> <span class="n">sdk</span><span class="o">.</span><span class="n">sh</span><span class="o">&gt;/</span><span class="n">sdk</span><span class="o">.</span><span class="n">sh</span> <span class="o">-</span><span class="n">y</span> <span class="o">-</span><span class="n">d</span> <span class="n">VVAS_SOURCES</span><span class="o">/</span><span class="n">sysroot</span><span class="o">/</span>
</pre></div>
</div>
<p>Now sysroot is installed. You are ready to build plugins and applications.</p>
</div>
<div class="section" id="build-plugins-and-libraries">
<h3>Build Plugins and Libraries<a class="headerlink" href="#build-plugins-and-libraries" title="Permalink to this headline">¶</a></h3>
<p>Get the VVAS Sources if not done already. Follow the steps mentioned below.</p>
<ul>
<li><p>Navigate to the folder, say <code class="docutils literal notranslate"><span class="pre">VVAS_SOURCES</span></code>,  where you want to clone the VVAS source tree.</p></li>
<li><p>Clone VVAS repo:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">git</span> <span class="n">clone</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">github</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">Xilinx</span><span class="o">/</span><span class="n">VVAS</span><span class="o">.</span><span class="n">git</span>
</pre></div>
</div>
<p>VVAS Source tree structure is described below:</p>
<div class="figure align-default">
<a class="reference internal image-reference" href="../../_images/image10.png"><img alt="../../_images/image10.png" src="../../_images/image10.png" style="width: 300px;" /></a>
</div>
<ul class="simple">
<li><p><strong>vvas-utils:</strong> This folder contains the source code for the VVAS kernel interface to be exposed by the acceleration software libraries, abstraction APIs on top of the Xilinx Runtime (XRT) tool, and common headers (for example, metadata).</p></li>
<li><p><strong>vvas-gst-plugins:</strong> This folder contains all the VVAS GSteamer plug-ins, including the infrastructure plug-ins and the Custom plug-ins.</p></li>
<li><p><strong>vvas-accel-sw-libs:</strong> Contains source for the acceleration software libraries that are called from the GStreamer infrastructure plug-ins.</p></li>
<li><p><strong>vvas-accel-hw:</strong> This folder contains the hardware kernel source code.</p></li>
<li><p><strong>vvas-examples:</strong> This repository hosts example solutions.</p></li>
<li><p><strong>vvas-platforms:</strong> This folder contains the reference platforms for different applications.</p></li>
</ul>
</li>
<li><p>Navigate to <code class="docutils literal notranslate"><span class="pre">VVAS_SOURCES/VVAS</span></code> folder</p></li>
<li><p>Unset the LD library path environment variable:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">unset</span> <span class="n">LD_LIBRARY_PATH</span>
</pre></div>
</div>
</li>
<li><p>Set the sysroot path:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">source</span> <span class="n">VVAS_SOURCES</span><span class="o">/</span><span class="n">sysroot</span><span class="o">/</span><span class="n">environment</span><span class="o">-</span><span class="n">setup</span><span class="o">-</span><span class="n">cortexa72</span><span class="o">-</span><span class="n">cortexa53</span><span class="o">-</span><span class="n">xilinx</span><span class="o">-</span><span class="n">linux</span>
</pre></div>
</div>
<p>You must have write permission to the sysroot.</p>
</li>
<li><p>Build VVAS plugins and libraries:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">./</span><span class="n">build_install_vvas</span><span class="o">.</span><span class="n">sh</span> <span class="n">Edge</span>
</pre></div>
</div>
</li>
<li><p>When above step is complete, VVAS plugins are generated as <code class="docutils literal notranslate"><span class="pre">install/vvas_installer.tar.gz</span></code>.</p></li>
<li><p>Copy <code class="docutils literal notranslate"><span class="pre">install/vvas_installer.tar.gz</span></code> onto the root folder (/) of the target board and untar it. VVAS Plugins are now installed on the target device.</p></li>
</ul>
</div>
<div class="section" id="build-smart-model-select-application">
<h3>Build Smart Model Select Application<a class="headerlink" href="#build-smart-model-select-application" title="Permalink to this headline">¶</a></h3>
<p>The example application (smart_model_select) is available in the “vvas-example” section of VVAS repository. Follow below steps to compile the application:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cd</span> <span class="o">&lt;</span><span class="n">VVAS_SOURCES</span><span class="o">&gt;/</span><span class="n">VVAS</span><span class="o">/</span><span class="n">vvas</span><span class="o">-</span><span class="n">examples</span><span class="o">/</span><span class="n">Embedded</span><span class="o">/</span><span class="n">smart_model_select</span><span class="o">/</span><span class="n">src</span>
<span class="n">unset</span> <span class="n">LD_LIBRARY_PATH</span>
<span class="n">source</span> <span class="o">&lt;</span><span class="n">sysroot</span> <span class="n">path</span><span class="o">&gt;/</span><span class="n">environment</span><span class="o">-</span><span class="n">setup</span><span class="o">-</span><span class="n">cortexa72</span><span class="o">-</span><span class="n">cortexa53</span><span class="o">-</span><span class="n">xilinx</span><span class="o">-</span><span class="n">linux</span>
<span class="n">make</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="known-issues">
<h2>Known Issues<a class="headerlink" href="#known-issues" title="Permalink to this headline">¶</a></h2>
<ol class="arabic simple">
<li><p>When we are executing 3 level cascade pipeline in a loop, by re-starting the pipeline after EOS, we start seeing shift in images. This issue is seen only in 3 stage ML cascading pipeline and only when we do start/stop in a loop. This is random in nature. The issue is not seen when we kept the same 3 stage cascade pipeline running continuously for 12 hrs.</p></li>
</ol>
</div>
</div>


           </div>
           
          </div>
          <footer>
<!-- Atalwar: Moved the footer code to layout.html to resolve conflict with the Xilinx template -->
</footer>

        </div>
      </div>


	  <!-- Sphinx Page Footer block -->
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="Tutorials/MultiChannelML.html" class="btn btn-neutral float-right" title="Multichannel ML" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="platforms_and_applications.html" class="btn btn-neutral float-left" title="Platforms And Applications" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo" class="copyright">
    <p class="footerinfo">
      <span class="lastupdated">
        Last updated on February 16, 2022.
      </span>

    </p>
	<br>
  </div>
      </div>
    </section>


  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

   <script type="text/javascript">
    jQuery(function() { Search.loadIndex("searchindex.js"); });
  </script>

  <script type="text/javascript" id="searchindexloader"></script>


  
  
    
  



  <!--  Xilinx template footer block -->
							</div>
						</div>
					</div>
				</div>
				<div class="xilinxExperienceFragments experiencefragment aem-GridColumn--default--none aem-GridColumn aem-GridColumn--offset--default--0 aem-GridColumn--default--16">
					<div class="xf-content-height">
						<div class="aem-Grid aem-Grid--16 aem-Grid--default--16 ">
							<div class="footer parbase aem-GridColumn--default--none aem-GridColumn aem-GridColumn--offset--default--0 aem-GridColumn--default--16">
								<noindex>
                  <!-- make footer fixed - NileshP -->
                  <style>
                        .footer {
                        position: fixed;
                        left: 0;
                        bottom: 0;
                        width: 100%;
                        }
                  </style>
                  <!-- make footer fixed NileshP-->
									<footer>
										<div class="aem-Grid aem-Grid--16">
											<div class="aem-GridColumn aem-GridColumn--xxxlarge--none aem-GridColumn--xsmall--16 aem-GridColumn--offset--xsmall--0 aem-GridColumn--xlarge--none aem-GridColumn--xxlarge--none aem-GridColumn--default--none aem-GridColumn--offset--large--1 aem-GridColumn--xlarge--12 aem-GridColumn--offset--default--0 aem-GridColumn--xxlarge--10 aem-GridColumn--offset--xlarge--2 aem-GridColumn--offset--xxlarge--3 aem-GridColumn--offset--xxxlarge--4 aem-GridColumn--xsmall--none aem-GridColumn--large--none aem-GridColumn aem-GridColumn--large--14 aem-GridColumn--xxxlarge--8 aem-GridColumn--default--16">
												<div class="container-fluid sub-footer">
													<div class="row">
														<div class="footerSocial parbase">
														
															<div class="col-md-push-6 col-lg-push-6 col-md-6 col-lg-6">
																<div class="lang-select dropup hidden-md hidden-lg">
		<button data-toggle="dropdown">
			<span class="fas fa-globe" aria-hidden="true"></span>
			<span>
				
					English
				</span>
		<span class="far fa-angle-down" aria-hidden="true"></span>
	</button>
	<ul class="dropdown-menu">
		<li>
				<a target="_blank" href="https://japan.xilinx.com/" target="_self">
					日本語
				</a>
			</li>
		<li>
				<a target="_blank" href="https://china.xilinx.com/" target="_self">
					简体中文
				</a>
			</li>
		</ul>
	</div>
																<ul class="list-inline pull-right social-menu">
																	<li>
																		<a target="_blank" href="https://www.linkedin.com/company/xilinx">
																		<span class="linkedin icon"></span>
																		<span class="sr-only">Connect on LinkedIn</span>
																		</a>
																	</li>
																	<li>
																		<a target="_blank" href="https://www.twitter.com/XilinxInc">
																		<span class="twitter icon"></span>
																		<span class="sr-only">Follow us on Twitter</span>
																		</a>
																	</li>
																	<li>
																		<a target="_blank" href="https://www.facebook.com/XilinxInc">
																		<span class="facebook icon"></span>
																		<span class="sr-only">Connect on Facebook</span>
																		</a>
																	</li>
																	<li>
																		<a target="_blank" href="https://www.youtube.com/XilinxInc">
																		<span class="youtube icon"></span>
																		<span class="sr-only">Watch us on YouTube</span>
																		</a>
																	</li>
																	<li>
																		<a target="_blank" href="https://www.xilinx.com/registration/subscriber-signup.html">
																		<span class="newsletter icon"></span>
																		<span class="sr-only">Subscribe to Newsletter</span>
																		</a>
																	</li>
																</ul>
																	<div class="lang-select dropup hidden-xs hidden-sm">
	<button data-toggle="dropdown">
		<span class="fas fa-globe" aria-hidden="true"></span>
		<span>
			
				English
			</span>
		<span class="far fa-angle-down" aria-hidden="true"></span>
	</button>
	<ul class="dropdown-menu">
		<li>
				<a target="_blank" href="https://japan.xilinx.com/" target="_self">
					日本語
				</a>
			</li>
		<li>
				<a target="_blank" href="https://china.xilinx.com/" target="_self">
					简体中文
				</a>
			</li>
		</ul>
	</div>
															</div>
														</div>
														<div class="col-md-pull-5 col-lg-pull-5 col-md-5 col-lg-5">
															<span class="copyright">©2022 Advanced Micro Devices, Inc</span>
														</div>

													</div>
													                    <div class="movethisrowtoleft row">
                        <div class="col-xs-24">
                            <ul class="sub-menu">
                                <li><a target="_blank" href="https://www.amd.com/en/corporate/copyright">Terms and Conditions</a></li>
                                <li><a target="_blank" href="https://www.amd.com/en/corporate/privacy">Privacy</a></li>
                                <li><a target="_blank" href="https://www.amd.com/en/corporate/cookies">Cookie Policy</a></li>
                                <li><a target="_blank" href="https://www.amd.com/en/corporate/trademarks">Trademarks</a></li>
                                <li><a target="_blank" href="https://www.amd.com/system/files/documents/statement-human-trafficking-forced-labor.pdf">Statement on Forced Labor</a></li>
                                <li><a target="_blank" href="https://www.amd.com/en/corporate/competition">Fair and Open Competition</a></li>
                                <li><a target="_blank" href="https://www.amd.com/system/files/documents/amd-uk-tax-strategy.pdf">UK Tax Strategy</a></li>
								<li><a target="_blank" href="https://docs.xilinx.com/v/u/9x6YvZKuWyhJId7y7RQQKA">Inclusive Terminology</a></li>
                                <li><a href="#cookiessettings" class="ot-sdk-show-settings">Cookies Settings</a></li>
                            </ul>
                        </div>
                    </div>
												</div>
											</div>
										</div>
									</footer>
								</noindex>
							</div>
						</div>
					</div>
				</div>
<div class="backToTop parbase aem-GridColumn--default--none aem-GridColumn aem-GridColumn--offset--default--0 aem-GridColumn--default--16"><noindex>
    <span data-component="backToTopButton" class="backToTopButton loaded">
        <ul>
            <li>
                <a href="https://www.author.xilinx.com/xx/rebrand/amd/en-amd-xilinx-header-footer.html#top" class="btn top">
                    <span class="fas fa-angle-up" aria-hidden="true"></span>
                </a>
            </li>
        </ul>
    </span>
</noindex></div>
			</div>
		</div>


		<script>window.CQ = window.CQ || {}</script>
		<script src="https://static.cloud.coveo.com/searchui/v2.4382/js/CoveoJsSearch.Lazy.min.js"></script>
		<script>
			var underscoreSetup = function () {
			  _.templateSettings.interpolate = /\{\{=([^-][\S\s]+?)\}\}/g;
			  _.templateSettings.evaluate = /\{\{([^-=][\S\s]+?)\}\}/g;
			  _.templateSettings.escape = /\{\{-([^=][\S\s]+?)\}\}/g;
			}

			underscoreSetup();
		</script>
	</body>
</html>